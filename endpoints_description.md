
# API/user/

## API/user/{user_id}

	Параметры:
	1) user_id

	Логика:
	1) выдача полной информации из БД по user (username, roles)

## API/user/register:

	Параметры:
	1) username
	2) password
	3) password confirm

	Логика:
	1) проверка на совпадение username (запрос в БД)
	 - совпадение -> ошибка "такой юзернейм существует"
	 - несовпадение -> пункт 2
	2) проверка валидности пароля (минимальное количество символов, сложность, отсутствие спецсимволов)
	 - невалиден -> ошибка валидности
	 - валиден -> шаг 3
	3) подтверждение пароля
	 - пароль не ввели -> ошибка, что надо ввести пароль
	 - пароль не совпдает -> ошибка, что пароль не совпадает
	 - пароль совпадает -> шаг 4
	4) запись нового юзера в БД
	5) запись хэша пароля в БД
	6) получение токена новым пользователем
	7) запись рефреш-токена в БД
	8) запись токена в редис
	9) запись сессии в БД с датой создания сессии

## API/user/login:

	Параметры:
	1) username
	2) password

	Логика:
	1) апи запрашивает БД на наличие username
	 - несовпадение -> ошибка "такой юзернейм не существует"
	 - совпадение -> пункт 2
	2) проверка валидности пароля (далем хэш, сравниваем с хэшем БД)
	 - несовпадение -> ошибка "пароль введен неверно" (реализовать 3 попытки ввода)
	 - совпадение -> пункт 3
	3) получение токена пользователем
	4) запись рефреш-токена в БД
	5) запись токена в редис
	6) запись сессии в БД с датой создания сессии

## API/user/edit:

	Параметры:
	1) username
	2) password
	3) new password
	4) new password confirm

	Логика (пользователь залогинен):
	1) смена юзернейма, проверка совпадения нового значения в БД
	 - несовпадение -> ошибка "такой юзернейм не существует"
	 - совпадение -> пункт 2
	2) проверка правильнсти ввода старого пароля
	3) проверка валидности пароля (минимальное количество симовлов, сложность, отсутствие спецсимволов)
	 - невалиден -> ошибка валидности
	 - валиден -> шаг 3
	4) подтверждение пароля
	 - пароль не ввели -> ошибка, что надо ввести пароль
	 - пароль не совпдает -> ошибка, что пароль не совпадает
	 - пароль совпадает -> шаг 4
	5) подтверждение пароля
	 - пароль не ввели -> ошибка, что надо ввести пароль
	 - пароль не совпдает -> ошибка, что пароль не совпадает
	 - пароль совпадает -> шаг 4
	6) запись нового занчения юзернейм в БД
	7) запись хэша пароля в БД (update)

## API/user/logout:

	Параметры:
	---

	Логика (пользователь залогинен):
	1) запись логаута в редис
	2) удаление токена из редис
	3) удаление рефреш-токена из БД

## API/user/history:

	Параметры:
	Нужны ли параметры за какой период смотреть?

	Логика (пользователь залогинен):
	1) запрос к БД
	2) вывод всех сессий в формате session-data : datetime

# API/role

## API/role/{role_id}

	Параметры:
	1) role_id

	Логика:
	1) выдача полной информации из БД по роли (role_name, usernames, permissions)


## API/role/create

	Параметры:
	1) role_name
	2) permissions
	3) usernames

	Логика:
	1) проверка на совпадение role_name (запрос в БД)
	 - совпадение -> ошибка "роль с таким именем существует"
	 - несовпадение -> пункт 2
	2) добавление permissions (выбираем из готового списка по совпадению с исходными параметрами, необязательный параметр, роль может быть пустой). 
	 - при несовпадении параметра -> ошибка, что такого параметра нет
	3) добавление списка username (выбираем из готового списка по совпадению с исходными параметрами, необязательный параметр, роль может быть пустой)
	 - при несовпадении параметра -> ошибка, что такого параметра нет
	4) Сохранить. Запись роли в БД.

## API/role/update

	Параметры:
	1) role_name
	2) permissions
	3) usernames

	Логика:
	1) получить role_id из БД
	1) замена role_name
	 - совпадение -> ошибка "роль с таким именем существует" (поиск в БД по role_name, кроме текущего role_id)
	 - несовпадение -> пункт 2
	2) добавление permissions (выбираем из готового списка по совпадению с исходными параметрами, необязательный параметр, роль может быть пустой). 
	 - при несовпадении параметра -> ошибка, что такого параметра нет
	3) добавление списка username (выбираем из готового списка по совпадению с исходными параметрами, необязательный параметр, роль может быть пустой)
	 - при несовпадении параметра -> ошибка, что такого параметра нет
	4) Сохранить изменения для role_id в БД.

## API/role/delete

	Параметры:
	1) role_name

	Логика:
	1) получить role_id из БД
	2) роль имеет неудаленные usernames (получаем из БД)
	 - да -> выдаем ошибку (у роли есть пользователи)
	 - нет -> пункт 3
	3) удалить роль из БД.
