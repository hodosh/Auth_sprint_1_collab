# Flask app

**Требования к окружению**

- Запущенный PostgreSQL
- Запущенный Redis

**Запуск**

`flask run` в консоли в папке src

**Создание миграции**

`flask db migrate -m "comment"` Создает новую миграцию

**Применение миграции**
`flask db upgrade` Применяет миграцию к базе данных

**Создание дефолтных ролей и пермишенов**

`flask create roles`

Нужно сделать после начальной миграции, до создания суперюзера

**Создание суперюзера**

`flask create superuser` далее ввести email и пароль в интерактивном режиме

**Токены**
При создании сессии пользователю выдается новый токен, для закрытых энпоинтов вход осуществляется по токену в хедерах запроса,
При выходе из аккаунта токен отзывается.
Redis используется для хранения отозванных токенов.

**Ролевой доступ**
Доступ к эндэнпоинтам осуществляется по указанным эндпоинту пермишенам, 
для этого из токена берется информация по пользователю и проверяется значение у данного пользователя указанных пермишенов.
Если true, то доступ к эндэнпоинту есть, иначе ошибка. 

**Тесты**
Тесты запускаются как локально, так и в компоузе `docker-compose-dev.yml`. Отчет формитуется в формате html.

**Авторы**
Артур Махмутов - https://github.com/hodosh

Илья Суворкин - https://github.com/ilyavfx

Шамиль Хайдаров - https://github.com/hsh01
