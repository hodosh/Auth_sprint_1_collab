# API/roles

![](img/api_role_00_main.png)

## API/roles/
    **Выходное значение:**
    Список ролей из БД

    
	**Логика:**
    1) Проверка уровня доступа, доступ для админа
	2) выдача списка ролей из БД

![](img/api_role_01_all_roles.png)

## API/roles/{role_id}

	**Параметры:**
	1) role_id
    2) accees_token

    **Выходное значение:**
    Полная информации из БД по роли (role_name, usernames, permissions)

	**Логика:**
    1) Проверка уровня доступа, доступ для админа
	1) выдача полной информации из БД по роли (role_name, usernames, permissions)

![](img/api_role_02_get_role_info.png)

## API/role/create

	**Параметры:**
	1) role_name
    2) accees_token
	3) permissions

    **Выходное значение:**
    Полная информации из БД по роли (role_name, usernames, permissions)


	Логика:
    1) Проверка уровня доступа, доступ для админа
	2) проверка на совпадение role_name (запрос в БД)
	 - совпадение -> ошибка "роль с таким именем существует"
	 - несовпадение -> пункт 2
	3) добавление permissions (выбираем из готового списка по совпадению с исходными параметрами, необязательный параметр, роль может быть пустой). 
	 - при несовпадении параметра -> ошибка, что такого параметра нет
	4) Сохранить. Запись роли в БД.

![](img/api_role_03_create_role.png)

## API/role/update

	Параметры:
	1) role_id
    2) accees_token
	3) permissions


    **Выходное значение:**
    Полная информации из БД по роли (role_name, usernames, permissions)

	Логика:
    1) Проверка уровня доступа, доступ для админа
	2) замена role_name
	 - совпадение -> ошибка "роль с таким именем существует" (поиск в БД по role_name, кроме текущего role_id)
	 - несовпадение -> пункт 2
	3) добавление permissions (выбираем из готового списка по совпадению с исходными параметрами, необязательный параметр, роль может быть пустой). 
	 - при несовпадении параметра -> ошибка, что такого параметра нет
	4) Сохранить изменения для role_id в БД.

![](img/api_role_04_update_role.png)

## API/role/delete

	**Параметры:**
	1) role_id
    2) accees_token

    **Выходное значение:**
    Сообщение об удалении

	Логика:
    1) Проверка уровня доступа, доступ для админа
	2) роль имеет неудаленные usernames (получаем из БД)
	 - да -> выдаем ошибку (у роли есть пользователи)
	 - нет -> пункт 3
	3) удалить роль из БД.

![](img/api_role_05_detele_role.png)